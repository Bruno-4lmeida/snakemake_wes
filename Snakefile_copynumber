# MAIN SNAKEFILE
configfile: "configcnvs.yaml"
# To get the samples names from sample dir
(SAMPLES,) = glob_wildcards(config["input"] + "{sample}_markduplicates_recal.bam")
#print(SAMPLES)
print(f"Sample names: {', '.join(SAMPLES)}")

# To import the rules for each tool
#include: "rules/cn.mops.snakefile"
include: "rules/delly_sv.snakefile"
include: "rules/delly_cnv.snakefile"
include: "rules/delly_filter.snakefile"
include: "rules/sansa.snakefile"
include: "rules/sansavcf.snakefile"
include: "rules/vep.snakefile"

# rule all for all output files
rule all:
    input:
        ### DELLY
        expand(config["output"] + "output_interomics/delly/cnvs/{sample}_cnv.bcf", sample=SAMPLES),
        expand(config["output"] + "output_interomics/delly/svs/{sample}_sv.bcf", sample=SAMPLES),
        ## DELLY FILTER (convert to vcf)
        expand(config["output"] + "output_interomics/delly/cnvs/{sample}_cnv.vcf.gz", sample=SAMPLES),
        expand(config["output"] + "output_interomics/delly/svs/{sample}_sv.vcf.gz", sample=SAMPLES),

        ## SANSA
        expand(config["output"] + "output_interomics/sansa/cnvs/{sample}_cnv_anno.bcf", sample=SAMPLES),
        expand(config["output"] + "output_interomics/sansa/cnvs/{sample}_cnv_query.tsv.gz", sample=SAMPLES),
        expand(config["output"] + "output_interomics/sansa/svs/{sample}_SV_anno.bcf", sample=SAMPLES),
        expand(config["output"] + "output_interomics/sansa/svs/{sample}_SV_query.tsv.gz", sample=SAMPLES),
        ## VCF SANSA
        expand(config["output"] + "output_interomics/sansa/cnvs/{sample}_cnv_anno.vcf.gz", sample=SAMPLES),
        expand(config["output"] + "output_interomics/sansa/svs/{sample}_SV_anno.vcf.gz", sample=SAMPLES),

        ## VEP
        #expand(config["output"] + "output_interomics/cnvs/cnmops/cnmops_cnvs_annotated.vcf", sample=SAMPLES),
        expand(config["output"] + "output_interomics/vep/cnvs/{sample}_cnvs_vep.vcf", sample=SAMPLES),
        expand(config["output"] + "output_interomics/vep/svs/{sample}_svs_vep.vcf", sample=SAMPLES),

